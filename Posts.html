<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Panel de Posts - NesArt</title>
  <link rel="stylesheet" href="style.css">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>

<body class="portfolio posts-admin">

<!-- ===== HEADER ===== -->
<header id="main-header">
  <div class="logo-container">
    <img src="images/LogoNesArt.png" class="logo">
  </div>

  <nav id="main-menu">
    <ul>
     <li><a href="Nesart.html">Nesart</a></li>
      <li><a href="Comisiones.html">Comisiones</a></li>
      <li><a href="Originales.html">Originales</a></li>
      <li><a href="SobreMi.html">Sobre mi</a></li>
      <li><a href="Contacto.html">Contacto</a></li>
      <li><a href="Blog.html">Blog</a></li>
      <li><a href="Posts.html" class="active">Posts</a></li>
    </ul>
  </nav>
</header>

<!-- ===== CONTENIDO ===== -->
<main class="page-content">

  <section class="posts-panel">

    <div class="posts-header">
      <h1>Gesti√≥n de posts</h1>
      <button id="new-post-btn">‚ûï Nuevo post</button>
    </div>

    <!-- LISTA POSTS -->
    <div id="posts-list" class="posts-grid"></div>

  </section>

</main>

<!-- ===== MODAL CREAR / EDITAR POST ===== -->
<div id="post-modal" class="modal">
  <div class="modal-content">

    <span id="close-modal">&times;</span>

    <h2 id="modal-title">Nuevo post</h2>

    <input type="hidden" id="post-id">

    <input type="text" id="post-title" placeholder="T√≠tulo del post">

    <input type="text" id="post-excerpt" placeholder="Descripci√≥n corta">

    <textarea id="post-content" rows="8" placeholder="Contenido completo del post"></textarea>

    <input type="text" id="post-category" placeholder="Categor√≠a">

    <input type="text" id="post-tags" placeholder="Etiquetas (separadas por comas)">

    <input type="file" id="post-image" accept="image/*">

    <button id="save-post-btn">Guardar post</button>

  </div>
</div>

<!-- ===== SCRIPT ===== -->
<script>
const postsKey = 'blogPosts';
let posts = JSON.parse(localStorage.getItem(postsKey)) || [];

const postsList = document.getElementById('posts-list');
const modal = document.getElementById('post-modal');

const newPostBtn = document.getElementById('new-post-btn');
const closeModal = document.getElementById('close-modal');
const savePostBtn = document.getElementById('save-post-btn');

const postIdInput = document.getElementById('post-id');
const titleInput = document.getElementById('post-title');
const excerptInput = document.getElementById('post-excerpt');
const contentInput = document.getElementById('post-content');
const categoryInput = document.getElementById('post-category');
const tagsInput = document.getElementById('post-tags');
const imageInput = document.getElementById('post-image');
const modalTitle = document.getElementById('modal-title');

/* ===== RENDER POSTS ===== */
function renderPosts() {
  postsList.innerHTML = '';

  posts.forEach(post => {
    const div = document.createElement('div');
    div.className = 'post-card';

    div.innerHTML = `
      <img src="${post.image}" alt="">
      <h3>${post.title}</h3>
      <p>${post.excerpt}</p>
      <div class="post-actions">
        <button onclick="editPost('${post.id}')">‚úèÔ∏è Editar</button>
        <button onclick="deletePost('${post.id}')">üóëÔ∏è Eliminar</button>
      </div>
    `;

    postsList.appendChild(div);
  });
}

/* ===== NUEVO POST ===== */
newPostBtn.onclick = () => {
  modal.style.display = 'flex';
  modalTitle.textContent = 'Nuevo post';
  postIdInput.value = '';
  titleInput.value = '';
  excerptInput.value = '';
  contentInput.value = '';
  categoryInput.value = '';
  tagsInput.value = '';
  imageInput.value = '';
};

/* ===== GUARDAR ===== */
savePostBtn.onclick = () => {
  const id = postIdInput.value || Date.now().toString();

  const reader = new FileReader();
  const file = imageInput.files[0];

  const save = (image) => {
    const postData = {
      id,
      title: titleInput.value,
      excerpt: excerptInput.value,
      content: contentInput.value,
      category: categoryInput.value,
      tags: tagsInput.value.split(',').map(t => t.trim()),
      image,
      date: new Date().toISOString()
    };

    const index = posts.findIndex(p => p.id === id);
    if (index >= 0) posts[index] = postData;
    else posts.push(postData);

    localStorage.setItem(postsKey, JSON.stringify(posts));
    modal.style.display = 'none';
    renderPosts();
  };

  if (file) {
    reader.onload = e => save(e.target.result);
    reader.readAsDataURL(file);
  } else {
    const existing = posts.find(p => p.id === id);
    save(existing ? existing.image : '');
  }
};

/* ===== EDITAR ===== */
window.editPost = (id) => {
  const post = posts.find(p => p.id === id);
  if (!post) return;

  modal.style.display = 'flex';
  modalTitle.textContent = 'Editar post';

  postIdInput.value = post.id;
  titleInput.value = post.title;
  excerptInput.value = post.excerpt;
  contentInput.value = post.content;
  categoryInput.value = post.category;
  tagsInput.value = post.tags.join(', ');
};

/* ===== ELIMINAR ===== */
window.deletePost = (id) => {
  if (!confirm('¬øEliminar este post?')) return;
  posts = posts.filter(p => p.id !== id);
  localStorage.setItem(postsKey, JSON.stringify(posts));
  renderPosts();
};

/* ===== CERRAR MODAL ===== */
closeModal.onclick = () => modal.style.display = 'none';
window.onclick = e => { if (e.target === modal) modal.style.display = 'none'; };

renderPosts();
</script>

</body>
</html>
